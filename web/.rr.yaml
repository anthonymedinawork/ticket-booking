version: '2.7'

rpc:
    listen: tcp://127.0.0.1:6001

logs:
    mode: production
    encoding: console
    level: error

server:
    command: "php app.php"
    relay: pipes

# serve static files
static:
    dir: "public"

http:
    address: 0.0.0.0:8080
    middleware: [ "gzip", "websockets", "static" ]
    static:
        dir: "public"
        forbid: [ ".php", ".htaccess" ]
    pool:
        num_workers: 1
        supervisor:
            max_worker_memory: 100

jobs:
    consume: [ ]
    pool:
        num_workers: 2
        supervisor:
            max_worker_memory: 100

temporal:
    address: temporal:7233
    activities:
        num_workers: 5

websockets:
    broker: default
    path: "/ws"

broadcast:
    default:
        driver: redis
        config:
            addrs:
                - redis:6379
